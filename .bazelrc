# Required for bazel 3.4+
# See https://github.com/bazelbuild/bazel/issues/10674#issuecomment-658270895
build --incompatible_objc_compile_info_migration

# We can't create a bzl_library for rules-swift because of its visibility,
# so circumvent by not using the sandbox
build --strategy=Stardoc=standalone


build --verbose_failures # Print the full command line for commands that failed
build --test_output=errors # Prints log file output to the console on failure

# By default do not build the tests for sources-with-prebuilt-binaries,
# because it takes quite some time. They will only run on CI
build --deleted_packages tests/ios/frameworks/sources-with-prebuilt-binaries

# Enable these features to test local and CI builds
# when swiftmodule caching is enabled.
build --features=swift.cacheable_swiftmodules
build --features=swift.use_global_module_cache
build --compilation_mode=dbg

# Debugging does not work in sandbox mode
build --genrule_strategy=standalone
build --spawn_strategy=standalone
